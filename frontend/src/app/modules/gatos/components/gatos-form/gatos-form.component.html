<!-- frontend/src/app/modules/gatos/components/gatos-form/gatos-form.component.html -->
<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <h2>{{ isEdit ? 'Editar Gato' : 'Crear Nuevo Gato' }}</h2>
      
      <form (ngSubmit)="guardarGato()" #gatoForm="ngForm">
        <div class="mb-3">
          <label for="nombre" class="form-label">Nombre</label>
          <input
            type="text"
            class="form-control"
            id="nombre"
            name="nombre"
            [(ngModel)]="gato.nombre"
            required
            #nombre="ngModel"
          >
          <div *ngIf="nombre.invalid && nombre.touched" class="text-danger">
            El nombre es requerido
          </div>
        </div>

        <div class="mb-3">
          <label for="raza" class="form-label">Raza</label>
          <input
            type="text"
            class="form-control"
            id="raza"
            name="raza"
            [(ngModel)]="gato.raza"
            required
            #raza="ngModel"
          >
          <div *ngIf="raza.invalid && raza.touched" class="text-danger">
            La raza es requerida
          </div>
        </div>

        <div class="mb-3">
          <label for="edad" class="form-label">Edad</label>
          <input
            type="number"
            class="form-control"
            id="edad"
            name="edad"
            [(ngModel)]="gato.edad"
            required
            min="0"
            max="30"
            #edad="ngModel"
          >
          <div *ngIf="edad.invalid && edad.touched" class="text-danger">
            La edad es requerida (0-30 a침os)
          </div>
        </div>

        <div class="mb-3">
          <label for="foto" class="form-label">URL de la Foto</label>
          <input
            type="text"
            class="form-control"
            id="foto"
            name="foto"
            [(ngModel)]="gato.foto"
            required
            #foto="ngModel"
            placeholder="https://cdn2.thecatapi.com/images/..."
          >
          <div *ngIf="foto.invalid && foto.touched" class="text-danger">
            La URL de la foto es requerida
          </div>

          <!-- Bot칩n para abrir modal de fotos -->
          <div class="mb-3">
            <button 
              type="button" 
              class="btn btn-outline-info"
              (click)="abrirModalFotos()"
            >
              游닞 Seleccionar Foto de Favoritos
            </button>
          </div>
        </div>

        <!-- Mostrar imagen preview -->
        <div *ngIf="gato.foto" class="mb-3">
          <label class="form-label">Vista Previa:</label>
          <div>
            <img 
              [src]="gato.foto" 
              alt="Preview" 
              class="img-thumbnail"
              style="max-height: 200px;"
              onerror="this.style.display='none'"
            >
          </div>
        </div>

        <div class="d-flex gap-2">
          <button 
            type="submit" 
            class="btn btn-primary"
            [disabled]="gatoForm.invalid"
          >
            {{ isEdit ? 'Actualizar' : 'Guardar' }}
          </button>
          <button 
            type="button" 
            class="btn btn-secondary" 
            (click)="cancelar()"
          >
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>


<!-- Modal para seleccionar fotos -->
<div *ngIf="mostrarModalFotos" class="modal show d-block" tabindex="-1" style="background-color: rgba(0,0,0,0.5)">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Seleccionar Foto de Favoritos</h5>
        <button type="button" class="btn-close" (click)="cerrarModalFotos()"></button>
      </div>
      <div class="modal-body">
        <div *ngIf="imagenesFavoritas.length === 0" class="alert alert-info">
          No hay im치genes favoritas. Marca algunas im치genes como favoritas en el m칩dulo de im치genes.
        </div>
        
        <div class="row">
          <div class="col-md-4 mb-3" *ngFor="let imagen of imagenesFavoritas">
            <div class="card h-100">
              <img 
                [src]="imagen.url" 
                [alt]="'Imagen ' + imagen.id"
                class="card-img-top"
                style="height: 150px; object-fit: cover; cursor: pointer;"
                (click)="seleccionarFoto(imagen.url)"
              >
              <div class="card-body text-center">
                <button 
                  class="btn btn-primary btn-sm"
                  (click)="seleccionarFoto(imagen.url)"
                >
                  Seleccionar
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="cerrarModalFotos()">
          Cerrar
        </button>
      </div>
    </div>
  </div>
</div>
